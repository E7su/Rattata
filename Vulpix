#!/usr/bin/python
# -*- coding: utf-8 -*-

import csv

pikachu = 0
m = 0
super_date = "01.12.2015 00:00"

def raichu(kalendar):
    for a in range(len(kalendar)):
        if kalendar[2] == ".":   # 2
            year = kalendar[6:10]  #
            month = kalendar[3:5]
            day = kalendar[:2]
            kalendar = year + "-" + month + "-" + day
        elif kalendar[2] != "." and len(kalendar)>=10:
            kalendar = kalendar[:10]
        else:
            kalendar = kalendar                      # because I can

    return kalendar

super_date = raichu(super_date)

with open('totoro.csv', 'rb') as f:
    reader = csv.reader(f)
    for row in reader:
        print
        print "======================================================================================="
        print row
        print

        lena = len(str(row))                          # For reading circle ';'
        m = k_1 = k_2 = k_3 = k_5 = k_6 = k_7 = 0
        date_login_am = date_login_ak = date_podkl_am = date_podkl_ak = date_otkl_am = date_otkl_ak = ""

        for i in range(11, lena):
            srez = tmp = str(row)
            if srez[i] == ";":
                m = m + 1                             # Counter ';'
                if m == 1:
                    k_1 = i
                    date_podkl_am = tmp
                    date_podkl_am = date_podkl_am[11:i]
                    date_podkl_am = raichu(date_podkl_am)
                elif m == 2:
                    k_2 = i
                    date_login_am = tmp[k_1+1:i]
                    date_login_am = raichu(date_login_am)
                elif m == 3:
                    k_3 = i
                    date_otkl_am = tmp[k_2+1:i]
                    date_otkl_am = raichu(date_otkl_am)
                elif m == 6:
                    k_5 = i
                elif m == 7:
                    k_6 = i
                    date_podkl_ak = tmp[k_5+1:i]
                    date_podkl_ak = raichu(date_podkl_ak)
                    print
                elif m == 8:
                    k_7 = i
                    date_login_ak = tmp[k_6+1:i]
                    date_login_ak = raichu(date_login_ak)
                elif m == 9:
                    date_otkl_ak = tmp[k_7+1:i]
                    date_otkl_ak = raichu(date_otkl_ak)

                    if date_podkl_ak < date_podkl_am and date_login_ak < date_podkl_am and date_podkl_ak != ""\
                    and date_login_ak != "" and date_login_am != "" and date_login_am > date_podkl_am\
                    and date_login_ak < super_date:

                        pikachu = pikachu + 1

    print "pika-pika: ", pikachu
